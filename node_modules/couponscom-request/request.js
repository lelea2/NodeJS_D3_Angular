'use strict';

/**
 * Usage:
 *      var request = require('couponscom-request');
 */

var externalRequest = require('request'),
    logger = require('couponscom-logger');

/**
 * Returns the request library object and adds metrics loging
 * Also sends metrics to couponscom statsD.
 */
function request (options, callback) {
    var startTime = (new Date()).getTime(),
        takenTime = 0;
    return externalRequest(options, function(error, response, body) {
        takenTime = (new Date()).getTime() - startTime;
        logger.metric('[METRIC] url=' + options.url + ' time=' + takenTime);
        callback(error, response, body);
    });
}

module.exports = request;
